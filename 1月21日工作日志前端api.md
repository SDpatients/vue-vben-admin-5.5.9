# 1月21日工作日志前端API

## 1. 概述

本文档描述工作日志管理模块的API接口，用于记录案件处理过程中的重要工作内容。所有接口均遵循RESTful风格，使用JSON格式进行数据交互。

## 2. 基础信息

- **Base URL**: `/api/v1/api/work-log`
- **Content-Type**: `application/json`
- **认证方式**: Bearer Token (在请求头中携带)
- **响应格式**: 统一使用 `Result` 包装

### 统一响应格式

```json
{
  "code": 200,
  "message": "success",
  "data": {}
}
```

## 3. API接口列表

### 3.1 创建工作日志

**接口说明**: 创建新的工作日志记录

**请求方式**: `POST`

**接口路径**: `/api/v1/api/work-log`

**请求体**:

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| caseId | Long | 是 | 案件ID |
| workDate | Date | 是 | 工作日期（格式：YYYY-MM-DD） |
| workType | String | 是 | 工作类型（见工作类型枚举） |
| workContent | String | 是 | 工作内容 |
| workResult | String | 否 | 工作结果 |
| attachmentIds | String | 否 | 附件ID列表（逗号分隔） |
| remark | String | 否 | 备注 |

**请求示例**:
```json
{
  "caseId": 1,
  "workDate": "2026-01-21",
  "workType": "CASE_INVESTIGATION",
  "workContent": "前往法院调取债务人财产线索",
  "workResult": "成功获取银行流水记录",
  "attachmentIds": "1,2,3",
  "remark": "需要进一步核实"
}
```

**响应示例**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "logId": 1
  }
}
```

**字段说明**:

| 字段名 | 类型 | 说明 |
|--------|------|------|
| logId | Long | 新创建的工作日志ID |

---

### 3.2 工作日志列表(分页)

**接口说明**: 查询工作日志列表，支持多条件筛选和分页

**请求方式**: `GET`

**接口路径**: `/api/v1/work-log/list`

**请求参数**:

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| pageNum | Integer | 否 | 页码，默认1 |
| pageSize | Integer | 否 | 每页大小，默认10 |
| caseId | Long | 否 | 案件ID |
| workType | String | 否 | 工作类型 |
| startDate | Date | 否 | 开始日期（格式：YYYY-MM-DD） |
| endDate | Date | 否 | 结束日期（格式：YYYY-MM-DD） |
| createUserId | Long | 否 | 创建者ID |
| status | String | 否 | 状态（ACTIVE/INACTIVE/DELETED） |

**请求示例**:
```
GET /api/v1/work-log/list?pageNum=1&pageSize=10&caseId=1&workType=CASE_INVESTIGATION&startDate=2026-01-01&endDate=2026-01-31
```

**响应示例**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 100,
    "list": [
      {
        "id": 1,
        "caseId": 1,
        "workDate": "2026-01-21",
        "workType": "CASE_INVESTIGATION",
        "workContent": "前往法院调取债务人财产线索",
        "workResult": "成功获取银行流水记录",
        "attachmentIds": "1,2,3",
        "remark": "需要进一步核实",
        "status": "ACTIVE",
        "createTime": "2026-01-21T10:00:00",
        "updateTime": "2026-01-21T10:00:00",
        "createUserId": 1,
        "updateUserId": 1,
        "isDeleted": false
      },
      {
        "id": 2,
        "caseId": 1,
        "workDate": "2026-01-20",
        "workType": "CREDITOR_CONTACT",
        "workContent": "联系主要债权人确认债权金额",
        "workResult": "已确认3笔债权",
        "attachmentIds": null,
        "remark": null,
        "status": "ACTIVE",
        "createTime": "2026-01-20T15:00:00",
        "updateTime": "2026-01-20T15:00:00",
        "createUserId": 1,
        "updateUserId": 1,
        "isDeleted": false
      }
    ]
  }
}
```

**字段说明**:

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | Long | 日志ID |
| caseId | Long | 案件ID |
| workDate | Date | 工作日期 |
| workType | String | 工作类型 |
| workContent | String | 工作内容 |
| workResult | String | 工作结果 |
| attachmentIds | String | 附件ID列表 |
| remark | String | 备注 |
| status | String | 状态 |
| createTime | DateTime | 创建时间 |
| updateTime | DateTime | 更新时间 |
| createUserId | Long | 创建者ID |
| updateUserId | Long | 修改者ID |
| isDeleted | Boolean | 是否删除 |

---

### 3.3 获取工作日志详情

**接口说明**: 根据日志ID查询工作日志详细信息

**请求方式**: `GET`

**接口路径**: `/api/v1/api/work-log/{logId}`

**路径参数**:

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| logId | Long | 是 | 日志ID |

**请求示例**:
```
GET /api/v1/api/work-log/1
```

**响应示例**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "caseId": 1,
    "workDate": "2026-01-21",
    "workType": "CASE_INVESTIGATION",
    "workContent": "前往法院调取债务人财产线索",
    "workResult": "成功获取银行流水记录",
    "attachmentIds": "1,2,3",
    "remark": "需要进一步核实",
    "status": "ACTIVE",
    "createTime": "2026-01-21T10:00:00",
    "updateTime": "2026-01-21T10:00:00",
    "createUserId": 1,
    "updateUserId": 1,
    "isDeleted": false
  }
}
```

---

### 3.4 更新工作日志信息

**接口说明**: 更新工作日志的基本信息

**请求方式**: `PUT`

**接口路径**: `/api/work-log/{logId}`

**路径参数**:

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| logId | Long | 是 | 日志ID |

**请求体**:

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| caseId | Long | 否 | 案件ID |
| workDate | Date | 否 | 工作日期（格式：YYYY-MM-DD） |
| workType | String | 是 | 工作类型 |
| workContent | String | 是 | 工作内容 |
| workResult | String | 否 | 工作结果 |
| attachmentIds | String | 否 | 附件ID列表（逗号分隔） |
| remark | String | 否 | 备注 |

**请求示例**:
```json
{
  "caseId": 1,
  "workDate": "2026-01-21",
  "workType": "CASE_INVESTIGATION",
  "workContent": "前往法院调取债务人财产线索",
  "workResult": "成功获取银行流水记录和房产信息",
  "attachmentIds": "1,2,3,4",
  "remark": "已核实完毕"
}
```

**响应示例**:
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

---

### 3.5 更新工作日志状态

**接口说明**: 更新工作日志的状态

**请求方式**: `PUT`

**接口路径**: `/api/work-log/{logId}/status`

**路径参数**:

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| logId | Long | 是 | 日志ID |

**请求体**:

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| status | String | 是 | 状态（ACTIVE/INACTIVE/DELETED） |

**请求示例**:
```json
{
  "status": "INACTIVE"
}
```

**响应示例**:
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

---

### 3.6 删除工作日志

**接口说明**: 删除指定的工作日志

**请求方式**: `DELETE`

**接口路径**: `/api/work-log/{logId}`

**路径参数**:

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| logId | Long | 是 | 日志ID |

**请求示例**:
```
DELETE /api/v1/work-log/1
```

**响应示例**:
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

---

## 4. 枚举值说明

### 4.1 工作类型枚举

| 类型值 | 类型名称 | 说明 |
|--------|----------|------|
| CASE_INVESTIGATION | 案件调查 | 案件相关调查工作 |
| CREDITOR_CONTACT | 债权人联系 | 与债权人的沟通联系 |
| ASSET_DISPOSAL | 资产处置 | 资产变价、处置相关工作 |
| COURT_COMMUNICATION | 法院沟通 | 与法院的沟通协调 |
| DOCUMENT_PREPARATION | 文书准备 | 各类法律文书准备 |
| MEETING_ORGANIZATION | 会议组织 | 组织债权人会议等 |
| OTHER | 其他 | 其他类型工作 |

### 4.2 状态枚举

| 状态值 | 状态名称 | 说明 |
|--------|----------|------|
| ACTIVE | 激活 | 正常状态，默认值 |
| INACTIVE | 停用 | 已停用 |
| DELETED | 已删除 | 已删除 |

---

## 5. 错误码说明

| 错误码 | 说明 |
|--------|------|
| 200 | 成功 |
| 400 | 请求参数错误 |
| 401 | 未授权 |
| 403 | 无权限 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

**常见错误响应示例**:

```json
{
  "code": 404,
  "message": "工作日志不存在: 999",
  "data": null
}
```

```json
{
  "code": 400,
  "message": "案件ID不能为空",
  "data": null
}
```

```json
{
  "code": 400,
  "message": "工作内容不能为空",
  "data": null
}
```

```json
{
  "code": 400,
  "message": "无效的工作类型: INVALID_TYPE",
  "data": null
}
```

---

## 6. 前端开发注意事项

### 6.1 分页处理
- 列表接口使用自定义分页格式
- 前端需要处理 `total`（总记录数）
- 分页从1开始，不是从0开始

### 6.2 日期格式
- 日期字段使用 `YYYY-MM-DD` 格式（如：`2026-01-21`）
- 日期时间字段使用ISO 8601格式（如：`2026-01-21T10:00:00`）
- 前端需要根据时区进行转换显示

### 6.3 工作类型选择
- 使用工作类型枚举值进行类型筛选和显示
- 建议在前端维护类型到中文的映射关系
- 可以下拉选择或标签形式展示

### 6.4 附件处理
- `attachmentIds` 字段为逗号分隔的字符串（如：`"1,2,3"`）
- 前端需要将数组转换为字符串发送
- 获取数据后需要将字符串转换为数组处理

### 6.5 权限控制
- 确保用户只能访问自己有权限的案件的工作日志
- 建议在路由守卫中进行权限校验
- 删除操作需要二次确认

### 6.6 错误处理
- 统一处理 `Result` 包装的响应
- 根据 `code` 字段判断请求是否成功
- 根据 `message` 字段显示错误提示

### 6.7 表单验证
- 必填字段：案件ID、工作日期、工作类型、工作内容
- 可选字段：工作结果、附件ID列表、备注
- 建议在前端进行表单验证，减少无效请求

---

## 7. 使用示例

### 7.1 创建工作日志

```javascript
const createWorkLog = async (workLog) => {
  const response = await fetch('/api/work-log', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${token}`
    },
    body: JSON.stringify(workLog)
  });
  return response.json();
};

// 使用示例
const newLog = {
  caseId: 1,
  workDate: '2026-01-21',
  workType: 'CASE_INVESTIGATION',
  workContent: '前往法院调取债务人财产线索',
  workResult: '成功获取银行流水记录',
  attachmentIds: '1,2,3',
  remark: '需要进一步核实'
};

const result = await createWorkLog(newLog);
console.log('创建成功，日志ID:', result.data.logId);
```

### 7.2 查询工作日志列表

```javascript
const getWorkLogList = async (params) => {
  const queryParams = new URLSearchParams(params).toString();
  const response = await fetch(`/api/v1/work-log/list?${queryParams}`, {
    headers: {
      'Authorization': `Bearer ${token}`
    }
  });
  return response.json();
};

// 使用示例
const result = await getWorkLogList({
  pageNum: 1,
  pageSize: 10,
  caseId: 1,
  workType: 'CASE_INVESTIGATION',
  startDate: '2026-01-01',
  endDate: '2026-01-31'
});

console.log('总记录数:', result.data.total);
console.log('日志列表:', result.data.list);
```

### 7.3 更新工作日志

```javascript
const updateWorkLog = async (logId, workLog) => {
  const response = await fetch(`/api/work-log/${logId}`, {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${token}`
    },
    body: JSON.stringify(workLog)
  });
  return response.json();
};

// 使用示例
const updatedLog = {
  workType: 'CASE_INVESTIGATION',
  workContent: '前往法院调取债务人财产线索',
  workResult: '成功获取银行流水记录和房产信息',
  attachmentIds: '1,2,3,4',
  remark: '已核实完毕'
};

const result = await updateWorkLog(1, updatedLog);
console.log('更新成功');
```

### 7.4 更新工作日志状态

```javascript
const updateStatus = async (logId, status) => {
  const response = await fetch(`/api/work-log/${logId}/status`, {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${token}`
    },
    body: JSON.stringify({ status })
  });
  return response.json();
};

// 使用示例
const result = await updateStatus(1, 'INACTIVE');
console.log('状态更新成功');
```

### 7.5 删除工作日志

```javascript
const deleteWorkLog = async (logId) => {
  const response = await fetch(`/api/v1/work-log/${logId}`, {
    method: 'DELETE',
    headers: {
      'Authorization': `Bearer ${token}`
    }
  });
  return response.json();
};

// 使用示例
const result = await deleteWorkLog(1);
console.log('删除成功');
```

### 7.6 附件ID处理

```javascript
// 数组转字符串（发送请求时）
const attachmentIdsArray = [1, 2, 3];
const attachmentIdsString = attachmentIdsArray.join(',');

// 字符串转数组（接收数据时）
const attachmentIdsString = '1,2,3';
const attachmentIdsArray = attachmentIdsString.split(',').map(id => parseInt(id));
```

---

## 8. 更新日志

| 版本 | 日期 | 说明 |
|------|------|------|
| 1.0 | 2026-01-21 | 初始版本，完成工作日志管理模块API |

---

## 9. 联系方式

如有API使用问题，请联系后端开发团队。
