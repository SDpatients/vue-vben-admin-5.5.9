# 账户交易明细API汇总

> 文档版本: v1.0  
> 更新日期: 2026-01-26  
> 适用对象: 前端开发人员

---

## 目录

1. [创建交易记录](#1-创建交易记录)
2. [查询交易记录列表](#2-查询交易记录列表)
3. [查询交易记录详情](#3-查询交易记录详情)
4. [更新交易记录](#4-更新交易记录)
5. [删除交易记录](#5-删除交易记录)
6. [获取银行账户交易明细](#6-获取银行账户交易明细)

---

## 通用说明

### 基础URL

```
http://your-domain/api
```

### 请求头

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| Content-Type | String | 是 | application/json |
| Authorization | String | 是 | Bearer {token} |

### 通用响应格式

所有接口返回统一的JSON格式：

```json
{
  "code": 200,
  "message": "success",
  "data": {}
}
```

### 状态码说明

| 状态码 | 说明 |
|--------|------|
| 200 | 请求成功 |
| 400 | 请求参数错误 |
| 401 | 未授权 |
| 403 | 禁止访问 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

### 错误码说明

| 错误码 | 错误信息 | 说明 |
|--------|----------|------|
| TRANSACTION_001 | 银行账户不存在 | 指定的银行账户ID不存在 |
| TRANSACTION_002 | 交易记录不存在 | 指定的交易记录ID不存在 |
| TRANSACTION_003 | 交易金额不能为负数 | 交易金额必须大于0 |
| TRANSACTION_004 | 无权访问该交易记录 | 当前用户无权访问该交易记录 |

---

## 1. 创建交易记录

### 接口信息

- **请求路径**: `/api/bank-account-transaction`
- **请求方法**: `POST`
- **接口描述**: 创建新的银行账户交易记录

### 请求参数

#### 请求体参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| accountId | Long | 是 | 银行账户ID |
| transactionType | String | 是 | 交易类型，IN-流入，OUT-流出 |
| amount | BigDecimal | 是 | 交易金额，保留两位小数 |
| transactionDate | String | 是 | 交易日期，格式：yyyy-MM-dd |
| summary | String | 否 | 交易摘要，最大500字符 |
| businessType | String | 否 | 业务类型（收款/付款/转账/利息收入/手续费等） |
| counterpartyAccount | String | 否 | 对方账户，最大100字符 |
| counterpartyName | String | 否 | 对方名称，最大100字符 |
| balanceAfter | BigDecimal | 否 | 交易后余额，保留两位小数 |
| attachmentId | Long | 否 | 附件ID |
| relatedBusinessId | Long | 否 | 关联业务单据ID |
| remark | String | 否 | 备注，最大500字符 |
| caseId | Long | 否 | 案件ID（如果不填，则使用关联银行账户的案件ID） |

### 请求示例

```json
{
  "accountId": 1,
  "transactionType": "IN",
  "amount": 500000.00,
  "transactionDate": "2026-01-10",
  "summary": "案件资金转入",
  "businessType": "收款",
  "counterpartyAccount": "6222021234567890",
  "counterpartyName": "张三",
  "balanceAfter": 500000.00,
  "remark": "案件初始资金",
  "caseId": 1
}
```

### 响应示例

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "transactionId": 1
  }
}
```

---

## 2. 查询交易记录列表

### 接口信息

- **请求路径**: `/api/bank-account-transaction/list`
- **请求方法**: `GET`
- **接口描述**: 分页查询银行账户交易记录列表，支持多条件筛选

### 请求参数

#### 查询参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| pageNum | Integer | 否 | 页码，默认1 |
| pageSize | Integer | 否 | 每页大小，默认10 |
| accountId | Long | 否 | 银行账户ID |
| transactionType | String | 否 | 交易类型，IN-流入，OUT-流出 |
| businessType | String | 否 | 业务类型 |
| startDate | String | 否 | 开始日期，格式：yyyy-MM-dd |
| endDate | String | 否 | 结束日期，格式：yyyy-MM-dd |
| caseId | Long | 否 | 案件ID |

### 请求示例

```
GET /api/bank-account-transaction/list?pageNum=1&pageSize=10&accountId=1&transactionType=IN&startDate=2026-01-01&endDate=2026-01-31
```

### 响应示例

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 30,
    "list": [
      {
        "id": 1,
        "status": "ACTIVE",
        "isDeleted": false,
        "createTime": "2026-01-10T10:00:00",
        "updateTime": "2026-01-10T10:00:00",
        "createUserId": 1,
        "updateUserId": 1,
        "accountId": 1,
        "accountName": "案件专用账户",
        "accountNumber": "6222020000000001",
        "bankName": "工商银行",
        "transactionType": "IN",
        "amount": 500000.00,
        "transactionDate": "2026-01-10",
        "summary": "案件资金转入",
        "businessType": "收款",
        "counterpartyAccount": "6222021234567890",
        "counterpartyName": "张三",
        "balanceAfter": 500000.00,
        "attachmentId": null,
        "relatedBusinessId": null,
        "remark": "案件初始资金",
        "caseId": 1,
        "caseNumber": "BK2026001",
        "caseName": "某公司破产清算案"
      }
    ]
  }
}
```

---

## 3. 查询交易记录详情

### 接口信息

- **请求路径**: `/api/bank-account-transaction/{transactionId}`
- **请求方法**: `GET`
- **接口描述**: 根据交易记录ID查询详细信息

### 请求参数

#### 路径参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| transactionId | Long | 是 | 交易记录ID |

### 请求示例

```
GET /api/bank-account-transaction/1
```

### 响应示例

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "status": "ACTIVE",
    "isDeleted": false,
    "createTime": "2026-01-10T10:00:00",
    "updateTime": "2026-01-10T10:00:00",
    "createUserId": 1,
    "updateUserId": 1,
    "accountId": 1,
    "transactionType": "IN",
    "amount": 500000.00,
    "transactionDate": "2026-01-10",
    "summary": "案件资金转入",
    "businessType": "收款",
    "counterpartyAccount": "6222021234567890",
    "counterpartyName": "张三",
    "balanceAfter": 500000.00,
    "attachmentId": null,
    "relatedBusinessId": null,
    "remark": "案件初始资金",
    "caseId": 1
  }
}
```

---

## 4. 更新交易记录

### 接口信息

- **请求路径**: `/api/bank-account-transaction/{transactionId}`
- **请求方法**: `PUT`
- **接口描述**: 更新银行账户交易记录信息

### 请求参数

#### 路径参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| transactionId | Long | 是 | 交易记录ID |

#### 请求体参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| transactionType | String | 否 | 交易类型，IN-流入，OUT-流出 |
| amount | BigDecimal | 否 | 交易金额，保留两位小数 |
| transactionDate | String | 否 | 交易日期，格式：yyyy-MM-dd |
| summary | String | 否 | 交易摘要，最大500字符 |
| businessType | String | 否 | 业务类型 |
| counterpartyAccount | String | 否 | 对方账户，最大100字符 |
| counterpartyName | String | 否 | 对方名称，最大100字符 |
| balanceAfter | BigDecimal | 否 | 交易后余额，保留两位小数 |
| attachmentId | Long | 否 | 附件ID |
| relatedBusinessId | Long | 否 | 关联业务单据ID |
| remark | String | 否 | 备注，最大500字符 |

### 请求示例

```json
{
  "amount": 550000.00,
  "summary": "案件资金转入（更新）",
  "remark": "案件初始资金（更新）"
}
```

### 响应示例

```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

---

## 5. 删除交易记录

### 接口信息

- **请求路径**: `/api/bank-account-transaction/{transactionId}`
- **请求方法**: `DELETE`
- **接口描述**: 删除银行账户交易记录

### 请求参数

#### 路径参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| transactionId | Long | 是 | 交易记录ID |

### 请求示例

```
DELETE /api/bank-account-transaction/1
```

### 响应示例

```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

---

## 6. 获取银行账户交易明细

### 接口信息

- **请求路径**: `/api/bank-account/{accountId}/transactions`
- **请求方法**: `GET`
- **接口描述**: 根据银行账户ID查询该账户的交易明细列表

### 请求参数

#### 路径参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| accountId | Long | 是 | 银行账户ID |

#### 查询参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| pageNum | Integer | 否 | 页码，默认1 |
| pageSize | Integer | 否 | 每页大小，默认10 |
| transactionType | String | 否 | 交易类型，IN-流入，OUT-流出 |
| businessType | String | 否 | 业务类型 |
| startDate | String | 否 | 开始日期，格式：yyyy-MM-dd |
| endDate | String | 否 | 结束日期，格式：yyyy-MM-dd |

### 请求示例

```
GET /api/bank-account/1/transactions?pageNum=1&pageSize=10&transactionType=IN&startDate=2026-01-01&endDate=2026-01-31
```

### 响应示例

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 6,
    "list": [
      {
        "id": 1,
        "status": "ACTIVE",
        "isDeleted": false,
        "createTime": "2026-01-10T10:00:00",
        "updateTime": "2026-01-10T10:00:00",
        "createUserId": 1,
        "updateUserId": 1,
        "accountId": 1,
        "accountName": "案件专用账户",
        "accountNumber": "6222020000000001",
        "bankName": "工商银行",
        "transactionType": "IN",
        "amount": 500000.00,
        "transactionDate": "2026-01-10",
        "summary": "案件资金转入",
        "businessType": "收款",
        "counterpartyAccount": "6222021234567890",
        "counterpartyName": "张三",
        "balanceAfter": 500000.00,
        "attachmentId": null,
        "relatedBusinessId": null,
        "remark": "案件初始资金",
        "caseId": 1,
        "caseNumber": "BK2026001",
        "caseName": "某公司破产清算案"
      }
    ]
  }
}
```

---

## 数据字典

### 交易类型 (transactionType)

| 值 | 说明 |
|----|------|
| IN | 流入 |
| OUT | 流出 |

### 业务类型 (businessType)

| 值 | 说明 |
|----|------|
| 收款 | 资金收入 |
| 付款 | 资金支出 |
| 转账 | 账户转账 |
| 利息收入 | 银行利息 |
| 手续费 | 银行手续费 |
| 其他 | 其他业务类型 |

### 状态 (status)

| 值 | 说明 |
|----|------|
| ACTIVE | 活跃 |
| INACTIVE | 非活跃 |

---

## 修改说明

### 新增API

本次新增了以下API接口：

1. `POST /api/bank-account-transaction` - 创建交易记录
2. `GET /api/bank-account-transaction/list` - 查询交易记录列表
3. `GET /api/bank-account-transaction/{transactionId}` - 查询交易记录详情
4. `PUT /api/bank-account-transaction/{transactionId}` - 更新交易记录
5. `DELETE /api/bank-account-transaction/{transactionId}` - 删除交易记录

### 修改API

本次修改了以下API接口：

1. `GET /api/bank-account/{accountId}/transactions` - 获取银行账户交易明细（新增）

该接口用于查询指定银行账户的交易明细，支持按交易类型、业务类型、日期范围等条件筛选。

---

## 注意事项

1. 所有接口都需要在请求头中携带有效的 Authorization token
2. 交易金额必须大于0，保留两位小数
3. 交易日期格式必须为 yyyy-MM-dd
4. 用户只能访问自己创建的交易记录，管理员可以访问所有记录
5. 删除交易记录为物理删除，操作不可恢复
6. 交易记录按交易日期和创建时间倒序排列
7. 如果创建交易记录时未指定案件ID，系统会自动使用关联银行账户的案件ID
