# 端口8085变更8080方案文档

## 一、概述

本文档描述了将前端所有从8085端口调用的API接口统一迁移到8080端口的完整方案。8080端口的后端将作为统一入口，对8085端口的接口进行中转处理。

## 二、当前8085端口API接口清单

### 2.1 API客户端配置

**文件位置**: `apps/web-ele/src/api/request.ts`

当前配置：
```typescript
// 8085端口API客户端（不进行Token校验）
export const requestClient8085 = new RequestClient({
  baseURL: 'http://192.168.0.120:8085',
  responseReturn: 'body',
});
```

### 2.2 API模块清单

| 模块文件 | 功能描述 | API路径 | 请求方法 |
|---------|---------|---------|---------|
| [debtor.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/debtor.ts) | 债务人管理 | `/api/web/selectAllDebtor` | GET |
| [debtor.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/debtor.ts) | 债务人详情 | `/api/web/selectDebtorById` | GET |
| [debtor.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/debtor.ts) | 添加债务人 | `/api/web/addDebtor` | POST |
| [debtor.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/debtor.ts) | 更新债务人 | `/api/web/updateDebtor` | POST |
| [debtor.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/debtor.ts) | 删除债务人 | `/api/web/deleteDebtor` | POST |
| [creditor.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/creditor.ts) | 债权人列表 | `/api/web/getAllCreditor` | GET |
| [creditor.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/creditor.ts) | 债权人详情 | `/api/web/selectOneCreditor` | GET |
| [creditor.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/creditor.ts) | 添加债权人 | `/api/web/addCreditor` | POST |
| [creditor.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/creditor.ts) | 更新债权人 | `/api/web/updateCreditor` | POST |
| [creditor.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/creditor.ts) | 删除债权人 | `/api/web/deleteCreditor` | POST |
| [work-plan.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/work-plan.ts) | 工作计划列表 | `/api/web/getWorkPlanBCVIEW` | GET |
| [work-plan.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/work-plan.ts) | 更新工作计划 | `/api/web/updateWorkPlan` | POST |
| [work-team.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/work-team.ts) | 工作团队列表 | `/api/web/getAllWorkTeam` | GET |
| [work-team.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/work-team.ts) | 工作团队视图 | `/api/web/getWorkTeamBaseView` | GET |
| [work-team.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/work-team.ts) | 添加工作团队 | `/api/web/addWorkTeam` | POST |
| [work-team.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/work-team.ts) | 更新工作团队 | `/api/web/update1` | POST |
| [bank-account.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/bank-account.ts) | 银行账户列表 | `/api/web/getAllBankAccounts` | GET |
| [bank-account.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/bank-account.ts) | 添加银行账户 | `/api/web/addBankAccounts` | POST |
| [bank-account.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/bank-account.ts) | 更新银行账户 | `/api/web/updateBankAccounts` | POST |
| [bank-account.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/bank-account.ts) | 删除银行账户 | `/api/web/deleteBankAccounts` | POST |
| [case.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case.ts) | 案件列表 | `/api/web/selectAllCase` | GET |
| [case.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case.ts) | 案件详情 | `/api/web/selectOneCase` | GET |
| [case.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case.ts) | 添加案件 | `/api/web/AddOneCase` | POST |
| [case.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case.ts) | 更新案件 | `/api/web/updateBCase` | POST |
| [case.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case.ts) | 案件进度 | `/api/web/selectAllCaseFor` | GET |
| [court.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/court.ts) | 法院列表 | `/api/web/getAllCourt` | GET |
| [court.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/court.ts) | 添加法院 | `/api/web/addCourt` | POST |
| [court.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/court.ts) | 更新法院 | `/api/web/updateCourt` | POST |
| [court.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/court.ts) | 删除法院 | `/api/web/deleteCourt` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 工作团队 | `/api/web/getAllWorkTeam` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 工作计划 | `/api/web/getAllWorkPlan` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 管理制度 | `/api/web/getAllManagement` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 印章管理 | `/api/web/getAllSealManagement` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 法律程序 | `/api/web/getAllLegalProcedure` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 财产接管 | `/api/web/getAllPropertyReceipt` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 应急预案 | `/api/web/getAllEmergency` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 财产处置计划 | `/api/web/getAllPropertyPlan` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 人事管理 | `/api/web/getAllPersonnelEmp` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 内部事务 | `/api/web/getAllInternalAffairs` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 经营管理 | `/api/web/getAllBusinessManagement` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 统一任务操作 | `/api/web/update1` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加工作团队 | `/api/web/addWorkTeam` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加工作计划 | `/api/web/addWorkPlan` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加管理制度 | `/api/web/addManagement` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加印章管理 | `/api/web/addSealManagement` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加法律程序 | `/api/web/addLegalProcedure` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加财产接管 | `/api/web/addPropertyReceipt` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加应急预案 | `/api/web/addEmergency` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加财产处置计划 | `/api/web/addPropertyPlan` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加人事管理 | `/api/web/addPersonnelEmployment` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加内部事务 | `/api/web/addInternalAffairs` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加合同管理 | `/api/web/addContractManagement` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 添加经营管理 | `/api/web/addBusinessManagement` | POST |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 破产财产分配方案 | `/api/web/getAllBankruptcyDistPlan` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 员工安置方案 | `/api/web/getAllEmployeeSPlan` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 优先受偿权 | `/api/web/getAllPriorityPayment` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 财产状况说明 | `/api/web/getAllPropertyDEC` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 存款管理 | `/api/web/getAllDepositManagement` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 债权确认 | `/api/web/getAllClaimConfirmation` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 债权人会议决议 | `/api/web/getAllCanRR` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 终止诉讼 | `/api/web/getAllTerminationLiti` | GET |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 追加分配 | `/api/web/getAllAdditionalDisiribution` | GET |
| [operation-tracker.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/operation-tracker.ts) | 操作记录查询 | `/api/web/SelectAllAFollow` | GET |

### 2.3 代理配置

**文件位置**: `apps/web-ele/vite.config.mts`

当前配置：
```typescript
'/api-8085': {
  changeOrigin: true,
  target: 'http://192.168.0.120:8085',
  ws: true,
  rewrite: (path: string) => path.replace(/^\/api-8085/, ''),
},
```

## 三、前端变更方案

### 3.1 修改API客户端配置

**文件**: `apps/web-ele/src/api/request.ts`

**变更内容**:
```typescript
// 修改前
export const requestClient8085 = new RequestClient({
  baseURL: 'http://192.168.0.120:8085',
  responseReturn: 'body',
});

// 修改后
export const requestClient8085 = new RequestClient({
  baseURL: 'http://192.168.0.120:8080',
  responseReturn: 'body',
});
```

### 3.2 修改Vite代理配置

**文件**: `apps/web-ele/vite.config.mts`

**变更内容**:
```typescript
// 修改前
proxy: {
  '/api': {
    changeOrigin: true,
    target: 'http://192.168.0.120:8080',
    ws: true,
    rewrite: (path: string) => path.replace(/^\/api/, '/api'),
  },
  '/api-8085': {
    changeOrigin: true,
    target: 'http://192.168.0.120:8085',
    ws: true,
    rewrite: (path: string) => path.replace(/^\/api-8085/, ''),
  },
}

// 修改后（删除/api-8085代理配置，统一使用/api）
proxy: {
  '/api': {
    changeOrigin: true,
    target: 'http://192.168.0.120:8080',
    ws: true,
    rewrite: (path: string) => path.replace(/^\/api/, '/api'),
  },
}
```

### 3.3 修改case-process.ts中的硬编码URL

**文件**: `apps/web-ele/src/api/core/case-process.ts`

**变更内容**:
```typescript
// 修改前
const API_BASE_URL =
  import.meta.env.VITE_GLOB_API_URL || 'http://192.168.0.120:8085';

// 修改后
const API_BASE_URL =
  import.meta.env.VITE_GLOB_API_URL || 'http://192.168.0.120:8080';
```

### 3.4 前端变更总结

| 文件 | 变更类型 | 变更内容 |
|------|---------|---------|
| [request.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/request.ts) | 修改baseURL | 8085 → 8080 |
| [vite.config.mts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/vite.config.mts) | 删除代理配置 | 删除/api-8085代理 |
| [case-process.ts](file:///c:/Users/Lenovo/Desktop/vue-vben-admin-5.5.9/apps/web-ele/src/api/core/case-process.ts) | 修改默认URL | 8085 → 8080 |

## 四、后端8080变更方案

### 4.1 架构设计

8080后端需要实现以下功能：

1. **统一入口**: 所有前端请求统一发送到8080端口
2. **请求中转**: 8080后端将案件相关请求转发到8085端口
3. **Token管理**: 8080后端负责JWT Token的验证和管理
4. **响应处理**: 将8085的响应统一处理后返回给前端

### 4.2 需要中转的API接口列表

#### 4.2.1 债务人管理模块

| 前端请求路径 | 中转到8085路径 | 请求方法 |
|-------------|---------------|---------|
| `/api/web/selectAllDebtor` | `http://192.168.0.120:8085/api/web/selectAllDebtor` | GET |
| `/api/web/selectDebtorById` | `http://192.168.0.120:8085/api/web/selectDebtorById` | GET |
| `/api/web/addDebtor` | `http://192.168.0.120:8085/api/web/addDebtor` | POST |
| `/api/web/updateDebtor` | `http://192.168.0.120:8085/api/web/updateDebtor` | POST |
| `/api/web/deleteDebtor` | `http://192.168.0.120:8085/api/web/deleteDebtor` | POST |

#### 4.2.2 债权人管理模块

| 前端请求路径 | 中转到8085路径 | 请求方法 |
|-------------|---------------|---------|
| `/api/web/getAllCreditor` | `http://192.168.0.120:8085/api/web/getAllCreditor` | GET |
| `/api/web/selectOneCreditor` | `http://192.168.0.120:8085/api/web/selectOneCreditor` | GET |
| `/api/web/addCreditor` | `http://192.168.0.120:8085/api/web/addCreditor` | POST |
| `/api/web/updateCreditor` | `http://192.168.0.120:8085/api/web/updateCreditor` | POST |
| `/api/web/deleteCreditor` | `http://192.168.0.120:8085/api/web/deleteCreditor` | POST |

#### 4.2.3 工作计划模块

| 前端请求路径 | 中转到8085路径 | 请求方法 |
|-------------|---------------|---------|
| `/api/web/getWorkPlanBCVIEW` | `http://192.168.0.120:8085/api/web/getWorkPlanBCVIEW` | GET |
| `/api/web/updateWorkPlan` | `http://192.168.0.120:8085/api/web/updateWorkPlan` | POST |

#### 4.2.4 工作团队模块

| 前端请求路径 | 中转到8085路径 | 请求方法 |
|-------------|---------------|---------|
| `/api/web/getAllWorkTeam` | `http://192.168.0.120:8085/api/web/getAllWorkTeam` | GET |
| `/api/web/getWorkTeamBaseView` | `http://192.168.0.120:8085/api/web/getWorkTeamBaseView` | GET |
| `/api/web/addWorkTeam` | `http://192.168.0.120:8085/api/web/addWorkTeam` | POST |
| `/api/web/update1` | `http://192.168.0.120:8085/api/web/update1` | POST |

#### 4.2.5 银行账户模块

| 前端请求路径 | 中转到8085路径 | 请求方法 |
|-------------|---------------|---------|
| `/api/web/getAllBankAccounts` | `http://192.168.0.120:8085/api/web/getAllBankAccounts` | GET |
| `/api/web/addBankAccounts` | `http://192.168.0.120:8085/api/web/addBankAccounts` | POST |
| `/api/web/updateBankAccounts` | `http://192.168.0.120:8085/api/web/updateBankAccounts` | POST |
| `/api/web/deleteBankAccounts` | `http://192.168.0.120:8085/api/web/deleteBankAccounts` | POST |

#### 4.2.6 案件管理模块

| 前端请求路径 | 中转到8085路径 | 请求方法 |
|-------------|---------------|---------|
| `/api/web/selectAllCase` | `http://192.168.0.120:8085/api/web/selectAllCase` | GET |
| `/api/web/selectOneCase` | `http://192.168.0.120:8085/api/web/selectOneCase` | GET |
| `/api/web/AddOneCase` | `http://192.168.0.120:8085/api/web/AddOneCase` | POST |
| `/api/web/updateBCase` | `http://192.168.0.120:8085/api/web/updateBCase` | POST |
| `/api/web/selectAllCaseFor` | `http://192.168.0.120:8085/api/web/selectAllCaseFor` | GET |

#### 4.2.7 法院管理模块

| 前端请求路径 | 中转到8085路径 | 请求方法 |
|-------------|---------------|---------|
| `/api/web/getAllCourt` | `http://192.168.0.120:8085/api/web/getAllCourt` | GET |
| `/api/web/addCourt` | `http://192.168.0.120:8085/api/web/addCourt` | POST |
| `/api/web/updateCourt` | `http://192.168.0.120:8085/api/web/updateCourt` | POST |
| `/api/web/deleteCourt` | `http://192.168.0.120:8085/api/web/deleteCourt` | POST |

#### 4.2.8 案件流程模块

| 前端请求路径 | 中转到8085路径 | 请求方法 |
|-------------|---------------|---------|
| `/api/web/getAllWorkTeam` | `http://192.168.0.120:8085/api/web/getAllWorkTeam` | GET |
| `/api/web/getAllWorkPlan` | `http://192.168.0.120:8085/api/web/getAllWorkPlan` | GET |
| `/api/web/getAllManagement` | `http://192.168.0.120:8085/api/web/getAllManagement` | GET |
| `/api/web/getAllSealManagement` | `http://192.168.0.120:8085/api/web/getAllSealManagement` | GET |
| `/api/web/getAllLegalProcedure` | `http://192.168.0.120:8085/api/web/getAllLegalProcedure` | GET |
| `/api/web/getAllPropertyReceipt` | `http://192.168.0.120:8085/api/web/getAllPropertyReceipt` | GET |
| `/api/web/getAllEmergency` | `http://192.168.0.120:8085/api/web/getAllEmergency` | GET |
| `/api/web/getAllPropertyPlan` | `http://192.168.0.120:8085/api/web/getAllPropertyPlan` | GET |
| `/api/web/getAllPersonnelEmp` | `http://192.168.0.120:8085/api/web/getAllPersonnelEmp` | GET |
| `/api/web/getAllInternalAffairs` | `http://192.168.0.120:8085/api/web/getAllInternalAffairs` | GET |
| `/api/web/getAllBusinessManagement` | `http://192.168.0.120:8085/api/web/getAllBusinessManagement` | GET |
| `/api/web/update1` | `http://192.168.0.120:8085/api/web/update1` | POST |
| `/api/web/addWorkTeam` | `http://192.168.0.120:8085/api/web/addWorkTeam` | POST |
| `/api/web/addWorkPlan` | `http://192.168.0.120:8085/api/web/addWorkPlan` | POST |
| `/api/web/addManagement` | `http://192.168.0.120:8085/api/web/addManagement` | POST |
| `/api/web/addSealManagement` | `http://192.168.0.120:8085/api/web/addSealManagement` | POST |
| `/api/web/addLegalProcedure` | `http://192.168.0.120:8085/api/web/addLegalProcedure` | POST |
| `/api/web/addPropertyReceipt` | `http://192.168.0.120:8085/api/web/addPropertyReceipt` | POST |
| `/api/web/addEmergency` | `http://192.168.0.120:8085/api/web/addEmergency` | POST |
| `/api/web/addPropertyPlan` | `http://192.168.0.120:8085/api/web/addPropertyPlan` | POST |
| `/api/web/addPersonnelEmployment` | `http://192.168.0.120:8085/api/web/addPersonnelEmployment` | POST |
| `/api/web/addInternalAffairs` | `http://192.168.0.120:8085/api/web/addInternalAffairs` | POST |
| `/api/web/addContractManagement` | `http://192.168.0.120:8085/api/web/addContractManagement` | POST |
| `/api/web/addBusinessManagement` | `http://192.168.0.120:8085/api/web/addBusinessManagement` | POST |
| `/api/web/getAllBankruptcyDistPlan` | `http://192.168.0.120:8085/api/web/getAllBankruptcyDistPlan` | GET |
| `/api/web/getAllEmployeeSPlan` | `http://192.168.0.120:8085/api/web/getAllEmployeeSPlan` | GET |
| `/api/web/getAllPriorityPayment` | `http://192.168.0.120:8085/api/web/getAllPriorityPayment` | GET |
| `/api/web/getAllPropertyDEC` | `http://192.168.0.120:8085/api/web/getAllPropertyDEC` | GET |
| `/api/web/getAllDepositManagement` | `http://192.168.0.120:8085/api/web/getAllDepositManagement` | GET |
| `/api/web/getAllClaimConfirmation` | `http://192.168.0.120:8085/api/web/getAllClaimConfirmation` | GET |
| `/api/web/getAllCanRR` | `http://192.168.0.120:8085/api/web/getAllCanRR` | GET |
| `/api/web/getAllTerminationLiti` | `http://192.168.0.120:8085/api/web/getAllTerminationLiti` | GET |
| `/api/web/getAllAdditionalDisiribution` | `http://192.168.0.120:8085/api/web/getAllAdditionalDisiribution` | GET |

#### 4.2.9 操作记录模块

| 前端请求路径 | 中转到8085路径 | 请求方法 |
|-------------|---------------|---------|
| `/api/web/SelectAllAFollow` | `http://192.168.0.120:8085/api/web/SelectAllAFollow` | GET |

### 4.3 后端实现要点

#### 4.3.1 请求拦截器

8080后端需要实现请求拦截器：

1. **Token验证**: 验证前端传入的JWT Token
2. **路由判断**: 判断请求是否需要转发到8085
3. **请求转发**: 将需要转发的请求转发到8085端口

#### 4.3.2 路由规则

**需要转发的路由规则**:
- 所有以 `/api/web/` 开头的请求
- 特定接口列表（见4.2节）

**不需要转发的路由**:
- 用户认证相关接口
- 权限管理相关接口
- 其他8080自有业务接口

#### 4.3.3 响应处理

8080后端需要处理8085返回的响应：

1. **格式统一**: 统一响应格式
2. **错误处理**: 统一错误处理逻辑
3. **日志记录**: 记录转发请求和响应

#### 4.3.4 Token管理

8080后端需要实现：

1. **Token生成**: 生成JWT Token
2. **Token验证**: 验证Token有效性
3. **Token刷新**: 支持Token刷新机制
4. **Token传递**: 将Token传递给8085（如果需要）

### 4.4 后端代码示例（伪代码）

```java
// 请求拦截器
@Component
public class CaseApiInterceptor implements HandlerInterceptor {
    
    @Value("${backend.case.url}")
    private String caseBackendUrl; // http://192.168.0.120:8085
    
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        String uri = request.getRequestURI();
        
        // 判断是否需要转发到8085
        if (needForwardToCaseBackend(uri)) {
            forwardToCaseBackend(request, response);
            return false;
        }
        
        return true;
    }
    
    private boolean needForwardToCaseBackend(String uri) {
        // 需要转发的接口列表
        List<String> forwardPaths = Arrays.asList(
            "/api/web/selectAllDebtor",
            "/api/web/selectDebtorById",
            "/api/web/addDebtor",
            // ... 其他接口
        );
        
        return forwardPaths.stream().anyMatch(uri::startsWith);
    }
    
    private void forwardToCaseBackend(HttpServletRequest request, HttpServletResponse response) {
        try {
            // 构建转发URL
            String forwardUrl = caseBackendUrl + request.getRequestURI() + "?" + request.getQueryString();
            
            // 转发请求
            RestTemplate restTemplate = new RestTemplate();
            ResponseEntity<String> responseEntity = restTemplate.exchange(
                forwardUrl,
                HttpMethod.valueOf(request.getMethod()),
                buildRequestEntity(request),
                String.class
            );
            
            // 返回响应
            response.setStatus(responseEntity.getStatusCodeValue());
            response.getWriter().write(responseEntity.getBody());
        } catch (Exception e) {
            // 错误处理
        }
    }
}
```

## 五、前后端关联关系

### 5.1 请求流程图

```
前端 (Vue)
  ↓
  ↓ HTTP请求 (带JWT Token)
  ↓
8080后端 (统一入口)
  ↓
  ↓ Token验证
  ↓
  ↓ 判断路由
  ↓
  ├─→ 8080自有业务 → 直接处理
  ↓
  └─→ 案件相关业务 → 转发到8085
                      ↓
                      ↓ HTTP请求
                      ↓
                    8085后端 (案件管理)
                      ↓
                      ↓ 处理业务
                      ↓
                      ↓ 返回响应
                      ↓
                    8080后端
                      ↓
                      ↓ 统一响应格式
                      ↓
                      ↓ 返回给前端
                    前端 (Vue)
```

### 5.2 数据流向

1. **前端 → 8080**: 前端发送HTTP请求，携带JWT Token
2. **8080 → 8085**: 8080验证Token后，将请求转发到8085
3. **8085 → 8080**: 8085处理请求后返回响应
4. **8080 → 前端**: 8080统一处理响应格式后返回给前端

### 5.3 Token传递机制

**方案一**: 8080验证Token，8085不需要Token
- 优点：8085无需改动
- 缺点：8080需要完全信任8085

**方案二**: 8080验证Token后，将Token传递给8085
- 优点：8085也能验证请求来源
- 缺点：需要修改8085的Token验证逻辑

**推荐方案**: 方案一，8080作为统一入口，8085作为内部服务

## 六、实施步骤

### 6.1 前端实施步骤

1. **修改API客户端配置**
   - 修改 `apps/web-ele/src/api/request.ts` 中的 `requestClient8085` baseURL

2. **修改Vite代理配置**
   - 删除 `apps/web-ele/vite.config.mts` 中的 `/api-8085` 代理配置

3. **修改硬编码URL**
   - 修改 `apps/web-ele/src/api/core/case-process.ts` 中的 `API_BASE_URL`

4. **测试验证**
   - 启动前端项目
   - 测试所有8085相关接口
   - 确认所有请求都发送到8080端口

### 6.2 后端实施步骤

1. **实现请求拦截器**
   - 创建拦截器判断是否需要转发
   - 实现请求转发逻辑

2. **实现响应处理器**
   - 统一响应格式
   - 错误处理

3. **配置路由规则**
   - 配置需要转发的接口列表
   - 配置不需要转发的接口列表

4. **测试验证**
   - 启动8080后端
   - 启动8085后端
   - 测试所有转发接口
   - 确认请求正确转发到8085

### 6.3 联调测试步骤

1. **启动所有服务**
   - 启动8080后端
   - 启动8085后端
   - 启动前端项目

2. **功能测试**
   - 测试债务人管理功能
   - 测试债权人管理功能
   - 测试工作计划功能
   - 测试工作团队功能
   - 测试银行账户功能
   - 测试案件管理功能
   - 测试法院管理功能
   - 测试案件流程功能
   - 测试操作记录功能

3. **性能测试**
   - 测试转发性能
   - 测试并发处理能力

4. **异常测试**
   - 测试8085服务不可用情况
   - 测试网络异常情况
   - 测试Token过期情况

## 七、风险评估与应对

### 7.1 风险点

1. **性能风险**: 请求转发增加了一层网络调用
   - **应对**: 优化转发逻辑，使用连接池

2. **可用性风险**: 8085服务不可用时影响功能
   - **应对**: 实现熔断机制，提供降级方案

3. **安全风险**: Token传递和验证
   - **应对**: 使用HTTPS，加强Token验证

4. **兼容性风险**: 8085接口变更影响转发
   - **应对**: 建立接口版本管理机制

### 7.2 回滚方案

如果迁移后出现问题，可以快速回滚：

1. **前端回滚**:
   - 恢复 `request.ts` 中的baseURL为8085
   - 恢复 `vite.config.mts` 中的 `/api-8085` 代理配置
   - 恢复 `case-process.ts` 中的 `API_BASE_URL` 为8085

2. **后端回滚**:
   - 禁用请求拦截器
   - 恢复原有路由配置

## 八、总结

本方案将前端所有8085端口的API接口统一迁移到8080端口，8080后端作为统一入口对8085接口进行中转处理。主要优势：

1. **统一管理**: 所有请求统一经过8080，便于统一管理和监控
2. **Token管理**: 8080统一管理Token，提高安全性
3. **扩展性**: 未来可以方便地添加其他后端服务
4. **可维护性**: 前端只需要对接一个后端服务

实施后，前端只需要访问8080端口，8085端口作为内部服务由8080统一调用。
