# 1月17日文书送达API汇总

## 概述

本文档描述了文书送达管理相关的所有RESTful API接口，包括文书送达记录的完整CRUD操作、发送状态更新、送达状态更新等功能。

## 数据库表关系

- **tb_document_delivery**（文书送达表）：存储文书送达记录信息
- **tb_bankrupt_case**（案件表）：关联案件信息，与文书送达表为一对多关系

## 基础URL

```
http://192.168.0.120:8080/document-delivery
```

## 通用响应格式

所有接口返回统一的响应格式：

### 成功响应
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {}
}
```

### 错误响应
```json
{
  "code": 400,
  "message": "错误描述",
  "data": null
}
```

---

## API接口列表

### 1. 创建文书送达

**功能描述**：创建新的文书送达记录

**请求URL**：`POST /document-delivery`

**请求方法**：POST

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| caseId | Long | 是 | 案件ID |
| documentName | String | 是 | 文书名称 |
| documentType | String | 否 | 文书类型 |
| recipientName | String | 是 | 受送达人 |
| recipientType | String | 否 | 受送达人类型 |
| contactPhone | String | 否 | 联系电话 |
| deliveryAddress | String | 否 | 送达地址 |
| deliveryMethod | String | 否 | 送达方式 |
| deliveryContent | String | 否 | 送达内容（富文本） |
| documentAttachment | String | 否 | 文书附件路径 |

**请求示例**：
```json
{
  "caseId": 1,
  "documentName": "破产受理通知书",
  "documentType": "COURT_NOTICE",
  "recipientName": "北京某科技有限公司",
  "recipientType": "DEBTOR",
  "contactPhone": "13800138001",
  "deliveryAddress": "北京市朝阳区建国路88号",
  "deliveryMethod": "POST",
  "deliveryContent": "<p>根据《中华人民共和国企业破产法》规定，本院已受理北京某科技有限公司的破产清算申请。</p>",
  "documentAttachment": "/uploads/documents/2026/01/notice_001.pdf"
}
```

**响应示例**：
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "deliveryId": 1
  }
}
```

---

### 2. 文书送达列表（分页）

**功能描述**：获取文书送达列表，支持分页和条件查询

**请求URL**：`GET /document-delivery/list`

**请求方法**：GET

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| pageNum | Integer | 否 | 页码，默认1 |
| pageSize | Integer | 否 | 每页大小，默认10 |
| caseId | Long | 否 | 案件ID |
| caseNumber | String | 否 | 案号（模糊查询） |
| documentType | String | 否 | 文书类型 |
| recipientType | String | 否 | 受送达人类型 |
| deliveryMethod | String | 否 | 送达方式 |
| sendStatus | String | 否 | 发送状态 |
| status | String | 否 | 状态（ACTIVE/INACTIVE/DELETED） |

**请求示例**：
```
GET /document-delivery/list?pageNum=1&pageSize=10&caseId=1&sendStatus=PENDING
```

**响应示例**：
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "total": 100,
    "list": [
      {
        "id": 1,
        "caseId": 1,
        "caseNumber": "2026-破字第001号",
        "caseName": "北京某科技有限公司破产清算案",
        "documentName": "破产受理通知书",
        "documentType": "COURT_NOTICE",
        "recipientName": "北京某科技有限公司",
        "recipientType": "DEBTOR",
        "contactPhone": "13800138001",
        "deliveryAddress": "北京市朝阳区建国路88号",
        "deliveryMethod": "POST",
        "sendStatus": "PENDING",
        "deliveryContent": "<p>根据《中华人民共和国企业破产法》规定，本院已受理北京某科技有限公司的破产清算申请。</p>",
        "documentAttachment": "/uploads/documents/2026/01/notice_001.pdf",
        "sendTime": null,
        "deliveryTime": null,
        "failureReason": null,
        "status": "ACTIVE",
        "createTime": "2026-01-10T09:00:00",
        "updateTime": "2026-01-10T09:00:00",
        "createUserId": 1,
        "updateUserId": 1
      }
    ]
  }
}
```

---

### 3. 文书送达列表详情（分页）

**功能描述**：获取文书送达列表，包含案件信息，支持分页和条件查询

**请求URL**：`GET /document-delivery/list/details`

**请求方法**：GET

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| pageNum | Integer | 否 | 页码，默认1 |
| pageSize | Integer | 否 | 每页大小，默认10 |
| caseId | Long | 否 | 案件ID |
| caseNumber | String | 否 | 案号（模糊查询） |
| documentType | String | 否 | 文书类型 |
| recipientType | String | 否 | 受送达人类型 |
| deliveryMethod | String | 否 | 送达方式 |
| sendStatus | String | 否 | 发送状态 |
| status | String | 否 | 状态（ACTIVE/INACTIVE/DELETED） |

**请求示例**：
```
GET /document-delivery/list/details?pageNum=1&pageSize=10&caseId=1
```

**响应示例**：
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "total": 100,
    "list": [
      {
        "id": 1,
        "caseId": 1,
        "caseNumber": "2026-破字第001号",
        "caseName": "北京某科技有限公司破产清算案",
        "documentName": "破产受理通知书",
        "documentType": "COURT_NOTICE",
        "recipientName": "北京某科技有限公司",
        "recipientType": "DEBTOR",
        "contactPhone": "13800138001",
        "deliveryAddress": "北京市朝阳区建国路88号",
        "deliveryMethod": "POST",
        "sendStatus": "DELIVERED",
        "deliveryContent": "<p>根据《中华人民共和国企业破产法》规定，本院已受理北京某科技有限公司的破产清算申请。</p>",
        "documentAttachment": "/uploads/documents/2026/01/notice_001.pdf",
        "sendTime": "2026-01-10T09:00:00",
        "deliveryTime": "2026-01-12T14:30:00",
        "failureReason": null,
        "status": "ACTIVE",
        "createTime": "2026-01-10T09:00:00",
        "updateTime": "2026-01-12T14:30:00",
        "createUserId": 1,
        "updateUserId": 1
      }
    ]
  }
}
```

---

### 4. 获取文书送达详情

**功能描述**：根据送达记录ID获取文书送达基本信息

**请求URL**：`GET /document-delivery/{deliveryId}`

**请求方法**：GET

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| deliveryId | Long | 是 | 送达记录ID（路径参数） |

**请求示例**：
```
GET /document-delivery/1
```

**响应示例**：
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": 1,
    "caseId": 1,
    "caseNumber": "2026-破字第001号",
    "caseName": "北京某科技有限公司破产清算案",
    "documentName": "破产受理通知书",
    "documentType": "COURT_NOTICE",
    "recipientName": "北京某科技有限公司",
    "recipientType": "DEBTOR",
    "contactPhone": "13800138001",
    "deliveryAddress": "北京市朝阳区建国路88号",
    "deliveryMethod": "POST",
    "sendStatus": "DELIVERED",
    "deliveryContent": "<p>根据《中华人民共和国企业破产法》规定，本院已受理北京某科技有限公司的破产清算申请。</p>",
    "documentAttachment": "/uploads/documents/2026/01/notice_001.pdf",
    "sendTime": "2026-01-10T09:00:00",
    "deliveryTime": "2026-01-12T14:30:00",
    "failureReason": null,
    "status": "ACTIVE",
    "createTime": "2026-01-10T09:00:00",
    "updateTime": "2026-01-12T14:30:00",
    "createUserId": 1,
    "updateUserId": 1
  }
}
```

---

### 5. 获取文书送达详情（含案件信息）

**功能描述**：获取文书送达详细信息，包含案件信息

**请求URL**：`GET /document-delivery/{deliveryId}/detail`

**请求方法**：GET

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| deliveryId | Long | 是 | 送达记录ID（路径参数） |

**请求示例**：
```
GET /document-delivery/1/detail
```

**响应示例**：
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": 1,
    "caseId": 1,
    "caseNumber": "2026-破字第001号",
    "caseName": "北京某科技有限公司破产清算案",
    "documentName": "破产受理通知书",
    "documentType": "COURT_NOTICE",
    "recipientName": "北京某科技有限公司",
    "recipientType": "DEBTOR",
    "contactPhone": "13800138001",
    "deliveryAddress": "北京市朝阳区建国路88号",
    "deliveryMethod": "POST",
    "sendStatus": "DELIVERED",
    "deliveryContent": "<p>根据《中华人民共和国企业破产法》规定，本院已受理北京某科技有限公司的破产清算申请。</p>",
    "documentAttachment": "/uploads/documents/2026/01/notice_001.pdf",
    "sendTime": "2026-01-10T09:00:00",
    "deliveryTime": "2026-01-12T14:30:00",
    "failureReason": null,
    "status": "ACTIVE",
    "createTime": "2026-01-10T09:00:00",
    "updateTime": "2026-01-12T14:30:00",
    "createUserId": 1,
    "updateUserId": 1
  }
}
```

---

### 6. 更新文书送达信息

**功能描述**：更新文书送达记录的基本信息

**请求URL**：`PUT /document-delivery/{deliveryId}`

**请求方法**：PUT

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| deliveryId | Long | 是 | 送达记录ID（路径参数） |
| caseId | Long | 否 | 案件ID |
| caseNumber | String | 否 | 案号 |
| caseName | String | 否 | 案件名称 |
| documentName | String | 否 | 文书名称 |
| documentType | String | 否 | 文书类型 |
| recipientName | String | 否 | 受送达人 |
| recipientType | String | 否 | 受送达人类型 |
| contactPhone | String | 否 | 联系电话 |
| deliveryAddress | String | 否 | 送达地址 |
| deliveryMethod | String | 否 | 送达方式 |
| sendStatus | String | 否 | 发送状态 |
| deliveryContent | String | 否 | 送达内容（富文本） |
| documentAttachment | String | 否 | 文书附件路径 |
| failureReason | String | 否 | 失败原因 |

**请求示例**：
```json
{
  "caseId": 1,
  "documentName": "破产受理通知书（更新）",
  "documentType": "COURT_NOTICE",
  "recipientName": "北京某科技有限公司",
  "recipientType": "DEBTOR",
  "contactPhone": "13800138001",
  "deliveryAddress": "北京市朝阳区建国路88号",
  "deliveryMethod": "POST",
  "sendStatus": "SENT",
  "deliveryContent": "<p>根据《中华人民共和国企业破产法》规定，本院已受理北京某科技有限公司的破产清算申请。</p>",
  "documentAttachment": "/uploads/documents/2026/01/notice_001.pdf"
}
```

**响应示例**：
```json
{
  "code": 200,
  "message": "操作成功",
  "data": null
}
```

---

### 7. 删除文书送达记录

**功能描述**：删除指定的文书送达记录

**请求URL**：`DELETE /document-delivery/{deliveryId}`

**请求方法**：DELETE

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| deliveryId | Long | 是 | 送达记录ID（路径参数） |

**请求示例**：
```
DELETE /document-delivery/1
```

**响应示例**：
```json
{
  "code": 200,
  "message": "操作成功",
  "data": null
}
```

---

### 8. 更新发送状态

**功能描述**：更新文书送达的发送状态

**请求URL**：`PUT /document-delivery/{deliveryId}/send-status`

**请求方法**：PUT

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| deliveryId | Long | 是 | 送达记录ID（路径参数） |
| sendStatus | String | 是 | 发送状态 |
| failureReason | String | 否 | 失败原因（当sendStatus为FAILED时必填） |

**请求示例**：
```
PUT /document-delivery/1/send-status?sendStatus=SENT
```

或

```
PUT /document-delivery/1/send-status?sendStatus=FAILED&failureReason=地址错误
```

**响应示例**：
```json
{
  "code": 200,
  "message": "操作成功",
  "data": null
}
```

---

### 9. 更新送达状态

**功能描述**：更新文书送达的送达状态

**请求URL**：`PUT /document-delivery/{deliveryId}/delivery-status`

**请求方法**：PUT

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| deliveryId | Long | 是 | 送达记录ID（路径参数） |
| sendStatus | String | 是 | 送达状态 |

**请求示例**：
```
PUT /document-delivery/1/delivery-status?sendStatus=DELIVERED
```

**响应示例**：
```json
{
  "code": 200,
  "message": "操作成功",
  "data": null
}
```

---

## 数据字典

### 状态字段

| 值 | 说明 |
|----|------|
| ACTIVE | 激活 |
| INACTIVE | 停用 |
| DELETED | 删除 |

### 发送状态

| 值 | 说明 |
|----|------|
| PENDING | 待发送 |
| SENDING | 发送中 |
| SENT | 已发送 |
| DELIVERED | 已送达 |
| FAILED | 发送失败 |
| REJECTED | 被拒收 |

### 文书类型

| 值 | 说明 |
|----|------|
| COURT_NOTICE | 法院通知 |
| JUDGMENT | 判决书 |
| VERDICT | 裁定书 |
| NOTICE | 通知书 |
| OTHER | 其他 |

### 受送达人类型

| 值 | 说明 |
|----|------|
| DEBTOR | 债务人 |
| CREDITOR | 债权人 |
| LAWYER | 律师 |
| COURT | 法院 |
| OTHER | 其他 |

### 送达方式

| 值 | 说明 |
|----|------|
| POST | 邮寄 |
| EMAIL | 邮件 |
| EXPRESS | 快递 |
| IN_PERSON | 当面送达 |
| ELECTRONIC | 电子送达 |
| OTHER | 其他 |

---

## 接口调用注意事项

1. **认证要求**：所有接口都需要在请求头中携带有效的认证token
   ```
   Authorization: Bearer {token}
   ```

2. **参数验证**：
   - 所有必填参数必须提供，否则返回400错误
   - 参数类型必须匹配，否则返回400错误
   - 枚举类型参数必须使用预定义的值

3. **分页查询**：
   - pageNum从1开始
   - pageSize建议不超过100
   - 返回结果按创建时间倒序排列

4. **错误处理**：
   - 400：请求参数错误
   - 404：资源不存在
   - 500：服务器内部错误

5. **关联查询**：
   - 获取送达记录详情时，如需案件信息请使用`/document-delivery/{deliveryId}/detail`接口

6. **删除操作**：
   - 删除送达记录为物理删除
   - 建议在删除前进行确认

7. **状态更新**：
   - 更新发送状态为SENT时，自动记录发送时间
   - 更新送达状态为DELIVERED时，自动记录送达时间
   - 更新发送状态为FAILED时，必须提供失败原因

8. **文件上传**：
   - 文书附件路径由文件上传接口返回
   - 附件路径格式：`/uploads/documents/年/月/文件名.扩展名`

---

## 版本历史

| 版本 | 日期 | 说明 |
|------|------|------|
| 1.0.0 | 2026-01-17 | 初始版本，实现文书送达的完整CRUD功能 |

---

## 联系方式

如有问题，请联系开发团队。
