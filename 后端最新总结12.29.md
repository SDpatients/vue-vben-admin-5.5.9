# 后端项目架构与API总结

## 1. 项目概述

本项目是一个基于Spring Boot的法律案件管理系统后端，提供了案件管理、用户认证、文件上传、实时通信等核心功能。

## 2. 技术栈

| 技术/框架 | 版本 | 用途 |
|----------|------|------|
| Spring Boot | 2.6.13 | 核心框架 |
| Java | 11 | 开发语言 |
| MyBatis | 2.2.2 | ORM框架 |
| SQL Server | - | 数据库 |
| Redis | - | 缓存、会话管理 |
| WebSocket | - | 实时通信 |
| JWT | 0.11.5 | 认证授权 |
| Lombok | 1.18.24 | 代码简化 |
| FastJSON | 1.2.83 | JSON处理 |
| 阿里云短信服务 | - | 短信发送 |

## 3. 项目结构

```
com.ls.law
├── config          # 配置类
├── controller      # API控制器
├── entity          # 实体类
├── exception       # 异常定义
├── handler         # 处理器（如WebSocket）
├── mapper          # MyBatis映射器
├── model           # 模型类（DTO、VO等）
├── service         # 业务逻辑层
├── utils           # 工具类
└── LawApplication  # 主启动类
```

## 4. 核心功能模块

### 4.1 用户认证与授权
- **控制器**: `AuthController`
- **认证方式**: JWT Token
- **功能**: 
  - 用户登录/注册
  - Token刷新
  - 权限验证

### 4.2 破产案件管理
- **控制器**: `BankruptCaseController`
- **功能**: 
  - 案件信息CRUD
  - 案件状态管理
  - 案件查询与统计

### 4.3 案件公告
- **控制器**: `CaseAnnouncementController`
- **功能**: 
  - 公告发布与管理
  - 公告查询

### 4.4 实时聊天
- **控制器**: `ChatController`
- **技术**: WebSocket
- **功能**: 实时消息通信

### 4.5 联系人管理
- **控制器**: `ContactController`
- **功能**: 联系人信息管理

### 4.6 文件上传
- **控制器**: `FileUploadController`
- **功能**: 
  - 多类型文件上传
  - 文件下载与管理
  - 上传路径: `C:/law-upload`
  - 支持类型: doc, docx, jpg, pdf, png, xls, xlsx, txt
  - 最大文件大小: 10MB

### 4.7 法律文书管理
- **控制器**: `LawDocumentController`
- **功能**: 法律文书的上传、下载与管理

### 4.8 服务记录管理
- **控制器**: `ServiceRecordController`
- **功能**: 服务记录的创建与查询

### 4.9 短信服务
- **控制器**: `SmsController`
- **技术**: 阿里云短信服务
- **功能**: 短信验证码发送

## 5. 配置信息

### 5.1 基础配置
- **服务器端口**: 8080
- **环境**: 开发环境

### 5.2 数据库配置
- **类型**: SQL Server
- **地址**: localhost:1433
- **数据库名**: law
- **用户名**: cjt
- **密码**: cjt123321

### 5.3 Redis配置
- **地址**: localhost:6379
- **端口**: 6379
- **数据库**: 0

### 5.4 JWT配置
- **密钥**: 长字符串（见application.properties）
- **过期时间**: 
  - Access Token: 15分钟（900000ms）
  - Refresh Token: 7天（604800000ms）

## 6. API设计规范

### 6.1 响应格式
```json
{
  "code": 200,
  "message": "成功",
  "data": {}
}
```

### 6.2 状态码
- 200: 成功
- 400: 请求参数错误
- 401: 未授权
- 403: 禁止访问
- 404: 资源不存在
- 500: 服务器内部错误

### 6.3 请求方式
- GET: 查询操作
- POST: 创建操作
- PUT: 更新操作
- DELETE: 删除操作

## 7. 开发注意事项

### 7.1 跨域处理
- 后端已配置跨域支持，前端可直接调用API

### 7.2 认证方式
- 所有需要认证的接口，需在请求头中携带 `Authorization` 字段，格式为 `Bearer {token}`

### 7.3 文件上传
- 支持单文件和多文件上传
- 文件大小限制：10MB
- 支持的文件类型：doc, docx, jpg, pdf, png, xls, xlsx, txt

### 7.4 实时通信
- WebSocket连接地址：`ws://localhost:8080/ws`

## 8. 部署信息

### 8.1 本地开发
- 启动命令：`mvn spring-boot:run`
- 访问地址：`http://localhost:8080`

### 8.2 打包部署
- 打包命令：`mvn clean package`
- 生成的JAR包：`target/law-0.0.1-SNAPSHOT.jar`
- 运行命令：`java -jar law-0.0.1-SNAPSHOT.jar`

## 9. 项目维护

### 9.1 日志管理
- 采用Spring Boot默认日志框架
- 日志级别：INFO

### 9.2 异常处理
- 全局异常处理器：统一处理系统异常
- 自定义异常：业务异常定义

## 10. 后续规划

- 完善权限管理系统
- 增加数据统计与分析功能
- 优化性能与安全性
- 增加更多第三方服务集成

## 11. 联系方式

如有问题或建议，请联系后端开发团队。

---

**更新时间**: 2025年12月29日
**文档版本**: v1.0