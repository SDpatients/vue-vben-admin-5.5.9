# 第四阶段前端方案

## 1. 概述
为了实现案件管理系统中各阶段流程处理的统一化，现参考第一阶段（phase1）的API实现，对第四阶段（phase4）的API进行了统一化修改。本方案详细说明第四阶段API的修改内容和使用方法，供前端开发人员参考。

## 2. 路由前缀
- **旧路由前缀**：`/api/web`
- **新路由前缀**：`/api/case/phase4`

## 3. 模块划分
第四阶段包含以下模块：

| 模块名称 | 中文名称 | 实体类 |
|---------|---------|-------|
| session | 债权人会议 | Session |
| meetingDocuments | 债权人会议文件 | MeetingDocuments |
| claimConfirmation | 债权确认 | ClaimConfirmation |
| remunerationPlan | 报酬方案 | RemunerationPlan |
| importantActions | 重要行为报告 | ImportantActions |
| setoffReview | 抵消权审查 | SetoffReview |
| auditReport | 审计报告 | AuditReport |
| assetValuation | 资产评估 | AssetValuation |
| propertyValuationPlan | 财产变价方案 | PropertyValuationPlan |
| auctionAgency | 拍卖机构 | AuctionAgency |
| bankruptcyDeclaration | 破产宣告 | BankruptcyDeclaration |
| propertyValuationImplementation | 财产变价实施 | PropertyValuationImplementation |

## 4. API命名规范
所有模块统一遵循以下API命名格式：

| 操作类型 | API路径格式 | 说明 |
|---------|------------|------|
| 新增 | `/{module}/add` | 新增单条或多条记录 |
| 修改 | `/{module}/update` | 修改单条记录 |
| 删除 | `/{module}/delete/{id}` | 根据ID删除记录 |
| 单个查询 | `/{module}/{id}` | 根据ID查询单条记录 |
| 列表查询 | `/{module}/list` | 查询所有记录 |
| 按案件ID查询 | `/{module}/listByCase/{caseId}` | 根据案件ID查询记录 |

## 5. 各模块API详情

### 5.1 债权人会议（session）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/session/list` | 无 | 查询所有债权人会议 |
| GET | `/session/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询债权人会议 |
| GET | `/session/{id}` | `id`：记录ID | 根据ID查询单个债权人会议 |
| POST | `/session/add` | `List<Session>` | 新增债权人会议（支持批量） |
| POST | `/session/update` | `Session` | 修改债权人会议 |
| GET | `/session/delete/{id}` | `id`：记录ID | 删除债权人会议 |

### 5.2 债权人会议文件（meetingDocuments）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/meetingDocuments/list` | 无 | 查询所有债权人会议文件 |
| GET | `/meetingDocuments/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询债权人会议文件 |
| GET | `/meetingDocuments/{id}` | `id`：记录ID | 根据ID查询单个债权人会议文件 |
| POST | `/meetingDocuments/add` | `List<MeetingDocuments>` | 新增债权人会议文件（支持批量） |
| POST | `/meetingDocuments/update` | `MeetingDocuments` | 修改债权人会议文件 |
| GET | `/meetingDocuments/delete/{id}` | `id`：记录ID | 删除债权人会议文件 |

### 5.3 债权确认（claimConfirmation）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/claimConfirmation/list` | 无 | 查询所有债权确认 |
| GET | `/claimConfirmation/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询债权确认 |
| GET | `/claimConfirmation/{id}` | `id`：记录ID | 根据ID查询单个债权确认 |
| POST | `/claimConfirmation/add` | `List<ClaimConfirmation>` | 新增债权确认（支持批量） |
| POST | `/claimConfirmation/update` | `ClaimConfirmation` | 修改债权确认 |
| GET | `/claimConfirmation/delete/{id}` | `id`：记录ID | 删除债权确认 |

### 5.4 报酬方案（remunerationPlan）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/remunerationPlan/list` | 无 | 查询所有报酬方案 |
| GET | `/remunerationPlan/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询报酬方案 |
| GET | `/remunerationPlan/{id}` | `id`：记录ID | 根据ID查询单个报酬方案 |
| POST | `/remunerationPlan/add` | `List<RemunerationPlan>` | 新增报酬方案（支持批量） |
| POST | `/remunerationPlan/update` | `RemunerationPlan` | 修改报酬方案 |
| GET | `/remunerationPlan/delete/{id}` | `id`：记录ID | 删除报酬方案 |

### 5.5 重要行为报告（importantActions）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/importantActions/list` | 无 | 查询所有重要行为报告 |
| GET | `/importantActions/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询重要行为报告 |
| GET | `/importantActions/{id}` | `id`：记录ID | 根据ID查询单个重要行为报告 |
| POST | `/importantActions/add` | `List<ImportantActions>` | 新增重要行为报告（支持批量） |
| POST | `/importantActions/update` | `ImportantActions` | 修改重要行为报告 |
| GET | `/importantActions/delete/{id}` | `id`：记录ID | 删除重要行为报告 |

### 5.6 抵消权审查（setoffReview）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/setoffReview/list` | 无 | 查询所有抵消权审查 |
| GET | `/setoffReview/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询抵消权审查 |
| GET | `/setoffReview/{id}` | `id`：记录ID | 根据ID查询单个抵消权审查 |
| POST | `/setoffReview/add` | `List<SetoffReview>` | 新增抵消权审查（支持批量） |
| POST | `/setoffReview/update` | `SetoffReview` | 修改抵消权审查 |
| GET | `/setoffReview/delete/{id}` | `id`：记录ID | 删除抵消权审查 |

### 5.7 审计报告（auditReport）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/auditReport/list` | 无 | 查询所有审计报告 |
| GET | `/auditReport/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询审计报告 |
| GET | `/auditReport/{id}` | `id`：记录ID | 根据ID查询单个审计报告 |
| POST | `/auditReport/add` | `List<AuditReport>` | 新增审计报告（支持批量） |
| POST | `/auditReport/update` | `AuditReport` | 修改审计报告 |
| GET | `/auditReport/delete/{id}` | `id`：记录ID | 删除审计报告 |

### 5.8 资产评估（assetValuation）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/assetValuation/list` | 无 | 查询所有资产评估 |
| GET | `/assetValuation/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询资产评估 |
| GET | `/assetValuation/{id}` | `id`：记录ID | 根据ID查询单个资产评估 |
| POST | `/assetValuation/add` | `List<AssetValuation>` | 新增资产评估（支持批量） |
| POST | `/assetValuation/update` | `AssetValuation` | 修改资产评估 |
| GET | `/assetValuation/delete/{id}` | `id`：记录ID | 删除资产评估 |

### 5.9 财产变价方案（propertyValuationPlan）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/propertyValuationPlan/list` | 无 | 查询所有财产变价方案 |
| GET | `/propertyValuationPlan/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询财产变价方案 |
| GET | `/propertyValuationPlan/{id}` | `id`：记录ID | 根据ID查询单个财产变价方案 |
| POST | `/propertyValuationPlan/add` | `List<PropertyValuationPlan>` | 新增财产变价方案（支持批量） |
| POST | `/propertyValuationPlan/update` | `PropertyValuationPlan` | 修改财产变价方案 |
| GET | `/propertyValuationPlan/delete/{id}` | `id`：记录ID | 删除财产变价方案 |

### 5.10 拍卖机构（auctionAgency）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/auctionAgency/list` | 无 | 查询所有拍卖机构 |
| GET | `/auctionAgency/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询拍卖机构 |
| GET | `/auctionAgency/{id}` | `id`：记录ID | 根据ID查询单个拍卖机构 |
| POST | `/auctionAgency/add` | `List<AuctionAgency>` | 新增拍卖机构（支持批量） |
| POST | `/auctionAgency/update` | `AuctionAgency` | 修改拍卖机构 |
| GET | `/auctionAgency/delete/{id}` | `id`：记录ID | 删除拍卖机构 |

### 5.11 破产宣告（bankruptcyDeclaration）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/bankruptcyDeclaration/list` | 无 | 查询所有破产宣告 |
| GET | `/bankruptcyDeclaration/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询破产宣告 |
| GET | `/bankruptcyDeclaration/{id}` | `id`：记录ID | 根据ID查询单个破产宣告 |
| POST | `/bankruptcyDeclaration/add` | `List<BankruptcyDeclaration>` | 新增破产宣告（支持批量） |
| POST | `/bankruptcyDeclaration/update` | `BankruptcyDeclaration` | 修改破产宣告 |
| GET | `/bankruptcyDeclaration/delete/{id}` | `id`：记录ID | 删除破产宣告 |

### 5.12 财产变价实施（propertyValuationImplementation）

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| GET | `/propertyValuationImplementation/list` | 无 | 查询所有财产变价实施 |
| GET | `/propertyValuationImplementation/listByCase/{caseId}` | `caseId`：案件ID | 根据案件ID查询财产变价实施 |
| GET | `/propertyValuationImplementation/{id}` | `id`：记录ID | 根据ID查询单个财产变价实施 |
| POST | `/propertyValuationImplementation/add` | `List<PropertyValuationImplementation>` | 新增财产变价实施（支持批量） |
| POST | `/propertyValuationImplementation/update` | `PropertyValuationImplementation` | 修改财产变价实施 |
| GET | `/propertyValuationImplementation/delete/{id}` | `id`：记录ID | 删除财产变价实施 |

### 5.13 阶段更新

| 请求方法 | API路径 | 参数 | 说明 |
|---------|---------|------|------|
| POST | `/phase/update` | `Map<String, Object>` | 更新第四、五阶段信息 |

## 6. 请求/响应格式

### 6.1 请求格式
- 新增和修改操作使用实体类作为请求体
- 批量新增支持`List<实体类>`格式
- 查询操作使用路径参数或查询参数

### 6.2 响应格式
所有API统一返回`Result`封装格式：

```json
{
  "code": 200, // 状态码，200表示成功，其他表示失败
  "message": "操作成功", // 提示信息
  "data": {} // 返回数据，根据具体API返回不同格式
}
```

## 7. 注意事项

1. **缺失实现**：部分API（如单个查询、删除操作）的Service层实现暂未完成，调用时会返回"暂未实现"提示，后续会逐步完善。

2. **参数类型**：所有按ID查询的API，路径参数`id`和`caseId`均为`Integer`类型。

3. **批量操作**：新增操作支持批量提交，建议在前端将多条记录组织成数组后一次性提交，减少HTTP请求次数。

4. **用户信息**：新增操作会自动从JWT令牌中获取当前用户信息，无需在请求体中传递。

5. **时间戳**：新增操作会自动设置当前时间为创建时间，无需在请求体中传递。

6. **状态字段**：新增操作会自动设置默认状态为"0"，无需在请求体中传递。

## 8. 前端集成建议

1. **API封装**：建议前端对第四阶段API进行统一封装，使用统一的请求拦截器和响应处理，便于维护和扩展。

2. **状态管理**：使用Vuex或Redux等状态管理工具管理第四阶段的数据，确保数据的一致性和可追溯性。

3. **表单验证**：在前端进行严格的表单验证，确保提交的数据符合后端要求，减少不必要的请求错误。

4. **错误处理**：统一处理API请求错误，向用户展示友好的错误提示，提高用户体验。

5. **性能优化**：合理使用缓存、分页加载等技术，优化前端性能，提高系统响应速度。

## 9. 版本历史

| 版本 | 日期 | 说明 |
|------|------|------|
| V1.0 | 2026-01-03 | 初始版本，完成第四阶段API统一化修改 |

## 10. 联系方式

如有疑问或建议，请联系后端开发人员。
