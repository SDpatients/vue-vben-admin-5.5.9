# 1月22日新增审批历史API文档

## 文档说明
本文档包含2026年1月22日新增的审批历史相关API接口，用于前端开发人员调用。

## 接口列表

| 接口名称 | 请求方式 | 接口地址 | 功能描述 |
|---------|---------|---------|---------|
| 根据案件ID获取审批历史 | GET | /approval/case/{caseId}/history | 根据案件ID查询该案件下的所有审批历史记录 |
| 新增审批历史记录 | POST | /approval/history | 新增一条审批历史记录 |
| 获取审批历史详情 | GET | /approval/history/{historyId} | 根据ID获取审批历史详情 |
| 更新审批历史记录 | PUT | /approval/history/{historyId} | 更新指定ID的审批历史记录 |
| 删除审批历史记录 | DELETE | /approval/history/{historyId} | 删除指定ID的审批历史记录 |

## 1. 根据案件ID获取审批历史记录

### 接口功能
根据案件ID查询该案件下的所有审批历史记录，支持分页查询。

### 接口地址
GET /approval/case/{caseId}/history

### 请求参数

#### 路径参数
| 参数名 | 类型 | 是否必填 | 说明 |
|-------|------|---------|------|
| caseId | Long | 是 | 案件ID |

#### 查询参数
| 参数名 | 类型 | 默认值 | 是否必填 | 说明 |
|-------|------|--------|---------|------|
| pageNum | Integer | 1 | 否 | 页码 |
| pageSize | Integer | 10 | 否 | 每页大小 |

### 请求示例
```
GET /approval/case/123/history?pageNum=1&pageSize=10
```

### 返回结果

#### 成功示例
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "total": 2,
    "list": [
      {
        "id": 1,
        "approvalId": 101,
        "caseId": 123,
        "approverId": 456,
        "approvalType": "CASE_SUBMIT",
        "approvalTitle": "案件提交审批",
        "approvalAttachment": "http://example.com/attachment1.pdf",
        "approvalStatus": "APPROVED",
        "approvalOpinion": "同意审批",
        "approvalDate": "2026-01-20T14:30:00",
        "createTime": "2026-01-20T14:30:00",
        "updateTime": "2026-01-20T14:30:00",
        "createUserId": 456,
        "updateUserId": 456,
        "isDeleted": false,
        "status": "ACTIVE"
      },
      {
        "id": 2,
        "approvalId": 102,
        "caseId": 123,
        "approverId": 789,
        "approvalType": "CASE_CLOSE",
        "approvalTitle": "案件结案审批",
        "approvalAttachment": "http://example.com/attachment2.pdf",
        "approvalStatus": "PENDING",
        "approvalOpinion": null,
        "approvalDate": "2026-01-21T09:15:00",
        "createTime": "2026-01-21T09:15:00",
        "updateTime": "2026-01-21T09:15:00",
        "createUserId": 789,
        "updateUserId": 789,
        "isDeleted": false,
        "status": "ACTIVE"
      }
    ]
  }
}
```

#### 失败示例
```json
{
  "code": 500,
  "message": "服务器内部错误",
  "data": null
}
```

### 返回字段说明

| 字段名 | 类型 | 说明 |
|-------|------|------|
| total | Long | 总记录数 |
| list | Array | 审批历史列表 |
| id | Long | 审批历史ID |
| approvalId | Long | 审批管理表ID |
| caseId | Long | 案件ID |
| approverId | Long | 审核人ID |
| approvalType | String | 审核类型: CASE_SUBMIT-案件提交, CASE_CLOSE-案件结案, FEE_APPLY-费用申请, EVIDENCE_UPLOAD-证据上传 |
| approvalTitle | String | 审核标题 |
| approvalAttachment | String | 审核附件 |
| approvalStatus | String | 审核状态: PENDING-待审核, APPROVED-已通过, REJECTED-已拒绝, CANCELLED-已取消 |
| approvalOpinion | String | 审核意见 |
| approvalDate | String | 审核日期 |
| createTime | String | 创建时间 |
| updateTime | String | 更新时间 |
| createUserId | Long | 创建者ID |
| updateUserId | Long | 修改者ID |
| isDeleted | Boolean | 是否删除: false-否, true-是 |
| status | String | 状态: ACTIVE-激活, INACTIVE-停用 |

## 2. 新增审批历史记录

### 接口功能
新增一条审批历史记录。

### 接口地址
POST /approval/history

### 请求参数

#### 请求体
| 参数名 | 类型 | 是否必填 | 说明 |
|-------|------|---------|------|
| approvalId | Long | 是 | 审批管理表ID |
| caseId | Long | 是 | 案件ID |
| approverId | Long | 是 | 审核人ID |
| approvalType | String | 是 | 审核类型: CASE_SUBMIT-案件提交, CASE_CLOSE-案件结案, FEE_APPLY-费用申请, EVIDENCE_UPLOAD-证据上传 |
| approvalTitle | String | 否 | 审核标题 |
| approvalAttachment | String | 否 | 审核附件 |
| approvalStatus | String | 是 | 审核状态: PENDING-待审核, APPROVED-已通过, REJECTED-已拒绝, CANCELLED-已取消 |
| approvalOpinion | String | 否 | 审核意见 |
| approvalDate | String | 是 | 审核日期，格式：yyyy-MM-dd'T'HH:mm:ss |

### 请求示例
```json
POST /approval/history
Content-Type: application/json

{
  "approvalId": 103,
  "caseId": 123,
  "approverId": 456,
  "approvalType": "FEE_APPLY",
  "approvalTitle": "费用申请审批",
  "approvalAttachment": "http://example.com/fee_attachment.pdf",
  "approvalStatus": "PENDING",
  "approvalOpinion": null,
  "approvalDate": "2026-01-22T10:00:00"
}
```

### 返回结果

#### 成功示例
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": 3,
    "approvalId": 103,
    "caseId": 123,
    "approverId": 456,
    "approvalType": "FEE_APPLY",
    "approvalTitle": "费用申请审批",
    "approvalAttachment": "http://example.com/fee_attachment.pdf",
    "approvalStatus": "PENDING",
    "approvalOpinion": null,
    "approvalDate": "2026-01-22T10:00:00",
    "createTime": "2026-01-22T10:05:00",
    "updateTime": "2026-01-22T10:05:00",
    "createUserId": 456,
    "updateUserId": 456,
    "isDeleted": false,
    "status": "ACTIVE"
  }
}
```

#### 失败示例
```json
{
  "code": 400,
  "message": "参数错误",
  "data": null
}
```

### 返回字段说明
同“根据案件ID获取审批历史记录”的返回字段说明。

## 3. 获取审批历史详情

### 接口功能
根据ID获取审批历史详情。

### 接口地址
GET /approval/history/{historyId}

### 请求参数

#### 路径参数
| 参数名 | 类型 | 是否必填 | 说明 |
|-------|------|---------|------|
| historyId | Long | 是 | 审批历史ID |

### 请求示例
```
GET /approval/history/3
```

### 返回结果

#### 成功示例
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": 3,
    "approvalId": 103,
    "caseId": 123,
    "approverId": 456,
    "approvalType": "FEE_APPLY",
    "approvalTitle": "费用申请审批",
    "approvalAttachment": "http://example.com/fee_attachment.pdf",
    "approvalStatus": "PENDING",
    "approvalOpinion": null,
    "approvalDate": "2026-01-22T10:00:00",
    "createTime": "2026-01-22T10:05:00",
    "updateTime": "2026-01-22T10:05:00",
    "createUserId": 456,
    "updateUserId": 456,
    "isDeleted": false,
    "status": "ACTIVE"
  }
}
```

#### 失败示例
```json
{
  "code": 404,
  "message": "审批历史不存在",
  "data": null
}
```

### 返回字段说明
同“根据案件ID获取审批历史记录”的返回字段说明。

## 4. 更新审批历史记录

### 接口功能
更新指定ID的审批历史记录。

### 接口地址
PUT /approval/history/{historyId}

### 请求参数

#### 路径参数
| 参数名 | 类型 | 是否必填 | 说明 |
|-------|------|---------|------|
| historyId | Long | 是 | 审批历史ID |

#### 请求体
| 参数名 | 类型 | 是否必填 | 说明 |
|-------|------|---------|------|
| approvalId | Long | 是 | 审批管理表ID |
| caseId | Long | 是 | 案件ID |
| approverId | Long | 是 | 审核人ID |
| approvalType | String | 是 | 审核类型: CASE_SUBMIT-案件提交, CASE_CLOSE-案件结案, FEE_APPLY-费用申请, EVIDENCE_UPLOAD-证据上传 |
| approvalTitle | String | 否 | 审核标题 |
| approvalAttachment | String | 否 | 审核附件 |
| approvalStatus | String | 是 | 审核状态: PENDING-待审核, APPROVED-已通过, REJECTED-已拒绝, CANCELLED-已取消 |
| approvalOpinion | String | 否 | 审核意见 |
| approvalDate | String | 是 | 审核日期，格式：yyyy-MM-dd'T'HH:mm:ss |

### 请求示例
```json
PUT /approval/history/3
Content-Type: application/json

{
  "approvalId": 103,
  "caseId": 123,
  "approverId": 456,
  "approvalType": "FEE_APPLY",
  "approvalTitle": "费用申请审批",
  "approvalAttachment": "http://example.com/fee_attachment.pdf",
  "approvalStatus": "APPROVED",
  "approvalOpinion": "同意费用申请",
  "approvalDate": "2026-01-22T10:30:00"
}
```

### 返回结果

#### 成功示例
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": 3,
    "approvalId": 103,
    "caseId": 123,
    "approverId": 456,
    "approvalType": "FEE_APPLY",
    "approvalTitle": "费用申请审批",
    "approvalAttachment": "http://example.com/fee_attachment.pdf",
    "approvalStatus": "APPROVED",
    "approvalOpinion": "同意费用申请",
    "approvalDate": "2026-01-22T10:30:00",
    "createTime": "2026-01-22T10:05:00",
    "updateTime": "2026-01-22T10:35:00",
    "createUserId": 456,
    "updateUserId": 456,
    "isDeleted": false,
    "status": "ACTIVE"
  }
}
```

#### 失败示例
```json
{
  "code": 404,
  "message": "审批历史不存在",
  "data": null
}
```

### 返回字段说明
同“根据案件ID获取审批历史记录”的返回字段说明。

## 5. 删除审批历史记录

### 接口功能
删除指定ID的审批历史记录。

### 接口地址
DELETE /approval/history/{historyId}

### 请求参数

#### 路径参数
| 参数名 | 类型 | 是否必填 | 说明 |
|-------|------|---------|------|
| historyId | Long | 是 | 审批历史ID |

### 请求示例
```
DELETE /approval/history/3
```

### 返回结果

#### 成功示例
```json
{
  "code": 200,
  "message": "操作成功",
  "data": null
}
```

#### 失败示例
```json
{
  "code": 404,
  "message": "审批历史不存在",
  "data": null
}
```

## 错误码说明

| 错误码 | 说明 |
|-------|------|
| 200 | 操作成功 |
| 400 | 参数错误 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

## 注意事项

1. 所有日期时间格式均为ISO 8601格式：yyyy-MM-dd'T'HH:mm:ss
2. 所有请求头需包含Content-Type: application/json
3. 接口调用前需确保已获取有效的认证令牌
4. 分页查询时，pageNum从1开始计数
5. 审核类型和审核状态必须使用指定的枚举值
