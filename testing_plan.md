# 文件上传模块分离 - 测试计划

## 1. 测试目的

验证文件上传模块分离后的功能是否正常工作，确保任务管理和按键管理两个模块的文件上传功能互不影响，数据清晰分离。

## 2. 测试环境

- **前端环境**：Vue 3 + Element Plus
- **后端环境**：Java Spring Boot + SQL Server 2008
- **数据库**：已添加MODULE_TYPE字段的CASE_FILES表

## 3. 测试内容

### 3.1 任务管理模块文件上传测试

#### 3.1.1 单文件上传
- **测试步骤**：
  1. 进入任务管理模块
  2. 选择一个任务
  3. 上传单个文件
  4. 检查文件是否成功上传
- **预期结果**：
  - 文件上传成功
  - 数据库中MODULE_TYPE字段值为`task`

#### 3.1.2 批量文件上传
- **测试步骤**：
  1. 进入任务管理模块
  2. 选择一个任务
  3. 上传多个文件
  4. 检查文件是否成功上传
- **预期结果**：
  - 所有文件上传成功
  - 数据库中所有文件的MODULE_TYPE字段值为`task`

#### 3.1.3 文件列表查询
- **测试步骤**：
  1. 进入任务管理模块
  2. 选择一个任务
  3. 查看已上传的文件列表
- **预期结果**：
  - 只显示该任务相关的文件
  - 不显示按键管理模块的文件

#### 3.1.4 文件删除
- **测试步骤**：
  1. 进入任务管理模块
  2. 选择一个任务
  3. 删除一个已上传的文件
  4. 检查文件是否成功删除
- **预期结果**：
  - 文件删除成功
  - 数据库中文件的is_deleted字段值为`1`

### 3.2 按键管理模块文件上传测试

#### 3.2.1 单文件上传
- **测试步骤**：
  1. 进入按键管理模块
  2. 选择一个按键
  3. 上传单个文件
  4. 检查文件是否成功上传
- **预期结果**：
  - 文件上传成功
  - 数据库中MODULE_TYPE字段值为`key`

#### 3.2.2 批量文件上传
- **测试步骤**：
  1. 进入按键管理模块
  2. 选择一个按键
  3. 上传多个文件
  4. 检查文件是否成功上传
- **预期结果**：
  - 所有文件上传成功
  - 数据库中所有文件的MODULE_TYPE字段值为`key`

#### 3.2.3 文件列表查询
- **测试步骤**：
  1. 进入按键管理模块
  2. 选择一个按键
  3. 查看已上传的文件列表
- **预期结果**：
  - 只显示该按键相关的文件
  - 不显示任务管理模块的文件

#### 3.2.4 文件删除
- **测试步骤**：
  1. 进入按键管理模块
  2. 选择一个按键
  3. 删除一个已上传的文件
  4. 检查文件是否成功删除
- **预期结果**：
  - 文件删除成功
  - 数据库中文件的is_deleted字段值为`1`

### 3.3 模块隔离测试

#### 3.3.1 数据隔离验证
- **测试步骤**：
  1. 在任务管理模块上传文件A
  2. 在按键管理模块上传文件B
  3. 分别查看两个模块的文件列表
- **预期结果**：
  - 任务管理模块只显示文件A
  - 按键管理模块只显示文件B
  - 数据库中文件A的MODULE_TYPE为`task`，文件B的MODULE_TYPE为`key`

#### 3.3.2 交叉访问验证
- **测试步骤**：
  1. 尝试在任务管理模块访问按键管理模块的文件
  2. 尝试在按键管理模块访问任务管理模块的文件
- **预期结果**：
  - 无法交叉访问
  - 只能访问本模块的文件

## 4. 测试工具

- **前端测试**：浏览器开发者工具 + 手动测试
- **后端测试**：Postman + JUnit
- **数据库测试**：SQL Server Management Studio

## 5. 测试数据

### 5.1 任务管理模块测试数据
- 任务ID：`TASK001`
- 测试文件：`task_file1.docx`, `task_file2.pdf`, `task_file3.jpg`

### 5.2 按键管理模块测试数据
- 按键ID：`KEY001`
- 测试文件：`key_file1.docx`, `key_file2.pdf`, `key_file3.jpg`

## 6. 测试结果记录

| 测试项 | 测试结果 | 备注 |
|--------|----------|------|
| 任务管理单文件上传 | | |
| 任务管理批量文件上传 | | |
| 任务管理文件列表查询 | | |
| 任务管理文件删除 | | |
| 按键管理单文件上传 | | |
| 按键管理批量文件上传 | | |
| 按键管理文件列表查询 | | |
| 按键管理文件删除 | | |
| 模块数据隔离 | | |
| 模块交叉访问 | | |

## 7. 预期测试结果

- 所有测试项通过
- 两个模块的文件数据完全分离
- 各模块只能访问和管理自己的文件
- 现有功能不受影响

## 8. 风险评估

| 风险项 | 影响程度 | 可能性 | 应对措施 |
|--------|----------|--------|----------|
| 现有功能受影响 | 高 | 低 | 做好备份，测试时注意观察现有功能 |
| 数据迁移失败 | 高 | 低 | 提前做好数据备份，制定回滚方案 |
| 模块类型参数传递错误 | 中 | 中 | 增加参数验证，添加日志记录 |

## 9. 测试完成标准

- 所有测试项通过
- 两个模块的文件上传功能正常工作
- 数据清晰分离，互不影响
- 现有功能不受影响

## 10. 后续工作

- 根据测试结果修复发现的问题
- 更新相关文档
- 对相关人员进行培训
- 监控系统运行情况
